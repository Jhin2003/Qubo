$collapsed-w: 84px;
$expanded-w: 280px;

.side-menu {
  box-sizing: border-box;
  display: flex;
  flex-direction: column;
  gap: 10px;
  background: #303030;
  border-right: 1px solid #2a2a2a;
  transition: width 0.28s ease;
  padding: 12px;
  width: $collapsed-w;
  will-change: width;

  &.open {
    width: $expanded-w;
    transition-delay: 0s; // immediate when manually opened
  }

  // when hover intent says open (but not manually open)
  &.hover-open {
    width: $expanded-w;
    transition-delay: 0.2s; // ~200ms delay to prevent flicker
  }

  .menu-toggle {
    background: #444;
    color: #fff;
    border: none;
    padding: 6px 8px;
    border-radius: 6px;
    cursor: pointer;
    margin-bottom: 10px;
    &:hover { background: #555; }
  }

  // Reveal labels when expanded by click or hover intent
  &.open .mi-label,
  &.hover-open .mi-label {
    opacity: 1;
    width: auto;
    transition-delay: 0.45s; // sync with width expand
  }

  /* ===== Optional polish: fade inner content after width completes ===== */

  // By default (collapsed), keep inner content invisible and non-interactive
  > *:not(.menu-toggle) {
    opacity: 0;
    pointer-events: none;
    transition: opacity .16s ease;
  }

  // When opened by click: wait for width (0.28s), then fade in content
  &.open > *:not(.menu-toggle) {
    opacity: 1;
    pointer-events: auto;
    transition-delay: 0.28s; // match width transition
  }

  // When opened by hover intent: wait (0.2s delay + 0.28s duration) then fade in
  &.hover-open > *:not(.menu-toggle) {
    opacity: 1;
    pointer-events: auto;
    transition-delay: 0.48s; // 0.2s (delay) + 0.28s (width)
  }
}
